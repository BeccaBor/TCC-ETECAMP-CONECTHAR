{{> navbar }}

<link rel="stylesheet" href="/css/gerenciamento.css">
<div id="page-gerenciamento">
  <main class="p-4 container-gestao">
    <!-- Sidebar -->
    <div class="sidebar">
      <h4>Gerenciar colaboradores</h4>
      <p>Edite, exclua e registre departamentos e colaboradores</p>

      <div class="box mb-2">
        <button id="btnRegistrarColaborador" class="btn w-100">
          Registrar Colaborador
        </button>
      </div>

      <!-- Novo botão de alternância -->
      <button id="btnTrocarExibicao" class="btn glass-btn">
        Alternar exibição
      </button>
    </div> <!-- ⚠️ FECHAMENTO CORRETO DA SIDEBAR -->

    <!-- Painel principal -->
    <div class="main-panel">
      <!-- Área onde os colaboradores serão renderizados -->
      <div class="listagem-colaboradores mt-3" id="listaColaboradores">
        <!-- Cards gerados dinamicamente -->
      </div>

      <!-- Nova visualização em lista por setor -->
      <div class="listagem-setor mt-3" id="listaPorSetor" style="display: none;">
        <!-- Estrutura gerada via JS -->
      </div>
    </div>
  </main>
</div>
<!-- Overlay de detalhes do colaborador -->
<div id="overlayColaborador" class="overlay" tabindex="-1" aria-hidden="true" style="display:none;">
  <div id="colabSelecionadoContainer" class="modal-dialog modal-dialog-centered">
    <div class="modal-content card-detalhes text-center">
      <img id="colabSelecionadoFoto" src="/img/fundofoda.png" alt="Foto do Colaborador"
        class="img-fluid rounded-circle mx-auto"
        style="max-width:140px; border:2px solid rgba(255,255,255,0.4); margin-bottom:1rem;">
      <h4 id="colabSelecionadoNome">Nome do Colaborador</h4>
      <p id="colabSelecionadoCPF">CPF: -</p>
      <p id="colabSelecionadoMatricula">Matrícula: -</p>
      <p id="colabSelecionadoCargo">Cargo: -</p>
      <p id="colabSelecionadoSetor">Setor: -</p>
      <p id="colabSelecionadoJornada">Jornada: -</p>
      <p id="colabSelecionadoHoras">Horas diárias: -</p>
      <p id="colabSelecionadoSalario">Salário: -</p>
      <h5 class="mt-3">Benefícios:</h5>
      <ul id="colabSelecionadoBeneficios" class="list-unstyled"></ul>

      <div class="d-flex justify-content-around mt-3">
        <button id="btnEditarColab" class="btn btn-primary">Editar</button>
        <button id="btnExcluirColab" class="btn btn-danger">Excluir</button>
        <button id="btnFecharColab" class="btn btn-secondary">Fechar</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal unificado para cadastro/edição -->
<div id="modalColaborador" class="modal fade" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
    <div class="modal-content p-4"
      style="background: rgba(255,255,255,0.12); backdrop-filter: blur(16px); border-radius: 20px;">
      <div class="modal-header border-0">
        <h5 class="modal-title w-100 text-center" id="tituloModalColaborador">Cadastrar Colaborador</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>

      <div class="modal-body">
        <form id="formColaborador" enctype="multipart/form-data">
          <div class="row mb-3">
            <div class="col-md-6 mb-2">
              <input type="text" id="numero_registro" name="numero_registro" placeholder="Número de Registro" readonly
                class="form-control">
            </div>
            <div class="col-md-6 mb-2">
              <input type="text" id="nome" name="nome" placeholder="Nome" required class="form-control">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6 mb-2">
              <input type="text" id="cpf" name="cpf" placeholder="CPF" class="form-control">
            </div>
            <div class="col-md-6 mb-2">
              <input type="password" id="senha" name="senha" placeholder="Senha" class="form-control">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6 mb-2">
              <select id="cargo" name="cargo" class="form-select">
                <option value="">Selecione um cargo</option>
              </select>
            </div>
            <div class="col-md-6 mb-2">
              <input type="text" id="setor" name="setor" placeholder="Setor" class="form-control">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6 mb-2">
              <select id="tipo_jornada" name="tipo_jornada" class="form-select">
                <option value="" disabled selected>Selecione a Jornada</option>
                <option value="6x1">6x1</option>
                <option value="5x2">5x2</option>
                <option value="4x3">4x3</option>
                <option value="flexivel">Flexível</option>
              </select>
            </div>
            <div class="col-md-6 mb-2">
              <input type="number" id="horas_diarias" name="horas_diarias" min="1" max="24" placeholder="Horas diárias"
                class="form-control">
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-md-6 mb-2">
              <input type="number" step="0.01" id="salario" name="salario" placeholder="Salário (R$)"
                class="form-control">
            </div>
            <div class="col-md-6 mb-2">
              <div id="containerBeneficios" class="border-0 p-2 rounded"
                style="background: transparent; max-height: 400px; overflow: hidden;">
                <!-- Os benefícios serão renderizados aqui dinamicamente -->
              </div>
            </div>
          </div>

          <div class="mb-3">
            <input type="file" id="foto" name="foto" accept="image/*" class="form-control">
          </div>

          <div id="preview-container" class="mb-3 text-center">
            <p>Pré-visualização:</p>
            <img id="previewFoto" src="/img/fundofoda.png" alt="Prévia da foto" class="img-fluid"
              style="max-width: 150px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.4);">
          </div>

          <div class="form-actions mt-3 d-flex justify-content-between">
            <button type="submit" class="btn btn-success">Salvar</button>
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/gerenciamentoScript.js"></script>